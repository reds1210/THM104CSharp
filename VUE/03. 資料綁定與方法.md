# 03. 資料綁定與方法

### 1. 核心概念：資料狀態 (Data)

在 Vue 中，我們不再像 jQuery 那樣直接去想「如何操作畫面」，而是轉變為思考「這個畫面需要哪些資料來驅動」。這些資料，就是所謂的**狀態 (State)**。

Vue 應用中所有的狀態，都定義在 `data` 選項中。

#### `data` 選項

我們在上一章已經見過 `data`，現在來深入了解它：

-   **它必須是一個函式**：`data` 必須被宣告為一個函式 (`function`)，並且這個函式必須 `return` 一個物件。
-   **回傳的物件是我們的狀態**：這個回傳的物件，就是當前 Vue 實例的「資料模型」。裡面所有的屬性，都可以在模板中直接使用。

```javascript
const app = Vue.createApp({
  data() {
    // 這裡必須回傳一個物件
    return {
      // 這些就是這個應用的「狀態」
      productName: '高品質藍牙耳機',
      price: 2500,
      stock: 10,
      isAvailable: true
    }
  }
})
```

**為什麼 `data` 必須是函式？**
這是為了確保每個 Vue **組件**實例都擁有一份獨立的資料複本。如果 `data` 直接是一個物件，那麼所有組件實例將會共享同一個資料物件，當一個地方修改了資料，所有地方都會被影響，這會導致災難性的後果。雖然我們在 CDN 模式下初期可能只用一個 Vue 實例，但養成這個習慣至關重要。

### 2. 模板語法：文字插值 `{{ }}`

一旦我們在 `data` 中定義了狀態，就可以在 HTML 模板中使用「Mustache」語法 (雙大括號 `{{ }}`) 來將資料渲染到畫面上。這被稱為**文字插值 (Text Interpolation)**。

```html
<div id="app">
  <h2>商品名稱：{{ productName }}</h2>
  <p>價格：NT$ {{ price }}</p>
  <p>庫存：{{ stock > 0 ? '尚有庫存' : '已售完' }}</p>
</div>

<script>
  const { createApp } = Vue
  createApp({
    data() {
      return {
        productName: '高品質藍牙耳機',
        price: 2500,
        stock: 10
      }
    }
  }).mount('#app')
</script>
```

-   **單次綁定**：Vue 會將 `{{ }}` 內的內容與 `data` 中對應的屬性進行「綁定」。當 `data` 中的屬性值改變時，畫面上的內容會**自動更新**。
-   **支援 JavaScript 表達式**：你可以在 `{{ }}` 中放入任何單行的 JavaScript 表達式，例如 `price * 0.8`、`productName.toUpperCase()` 或三元運算子。但請保持簡單，複雜的邏輯應該交給 `methods` 或 `computed`。

### 3. 行為定義：`methods` 選項

如果說 `data` 是 Vue 應用的「名詞」(狀態)，那麼 `methods` 就是「動詞」(行為)。`methods` 選項允許我們定義可以在模板中呼叫的函式。

`methods` 是一個物件，裡面包含了所有你想定義的函式。

#### 範例：

讓我們為剛剛的商品頁面加上「加入購物車」的按鈕。

```html
<div id="app">
  <h2>{{ productName }}</h2>
  <p>庫存：{{ stock }}</p>
  <!-- 我們將在下一章詳解 v-on:click -->
  <button v-on:click="addToCart">加入購物車</button>
</div>

<script>
  const { createApp } = Vue
  createApp({
    data() {
      return {
        productName: '高品質藍牙耳機',
        stock: 10
      }
    },
    // methods 是一個物件
    methods: {
      // 在這裡定義我們的函式
      addToCart() {
        // 在 methods 中，使用 `this` 來存取 data 中的屬性
        if (this.stock > 0) {
          this.stock--; // 每點擊一次，庫存就減 1
          console.log('成功加入購物車！剩餘庫存：', this.stock);
        } else {
          console.log('庫存不足！');
        }
      }
    }
  }).mount('#app')
</script>
```

**程式碼解析：**

-   `methods: { ... }`: 我們新增了 `methods` 選項，它是一個物件。
-   `addToCart() { ... }`: `addToCart` 是我們定義的一個方法。
-   **`this` 的重要性**：在 `methods` 內部，`this` 會指向當前的 Vue 實例。因此，你可以透過 `this.stock` 來存取 `data` 中定義的 `stock` 屬性，也可以透過 `this.addToCart` 來呼叫其他方法。**不可以使用箭頭函式 `() => {}` 來定義 method**，因為箭頭函式沒有自己的 `this`，會導致你無法存取到 Vue 實例。
